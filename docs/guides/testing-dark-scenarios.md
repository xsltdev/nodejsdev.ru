---
description: –í —Å—Ç–∞—Ç—å–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è, –∫–∞–∫–∏–µ –ø—Ä–æ—Å—Ç—ã–µ –∏ –∫–æ—Ä–æ—Ç–∫–∏–µ —Ç–µ—Å—Ç—ã —Å—Ç–æ–∏—Ç –ø–∏—Å–∞—Ç—å –Ω–∞ –ª—é–±–æ–µ node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
---

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–º–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤–∞—à–µ–≥–æ Node.js-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

_–í —Å—Ç–∞—Ç—å–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è, –∫–∞–∫–∏–µ –ø—Ä–æ—Å—Ç—ã–µ –∏ –∫–æ—Ä–æ—Ç–∫–∏–µ —Ç–µ—Å—Ç—ã —Å—Ç–æ–∏—Ç –ø–∏—Å–∞—Ç—å –Ω–∞ –ª—é–±–æ–µ node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –•–æ—Ç—è –≤ —Ü–µ–ª–æ–º —ç—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –Ω–µ —Ç–æ–ª—å–∫–æ node.js, –Ω–æ —ç—Ç–∞ —Å—Ç–∞—Ç—å—è –ø–æ—Å–≤—è—â–µ–Ω–∞ –∏–º–µ–Ω–Ω–æ node.js –∏ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∫–µ–π—Å–æ–≤._

## –ì–¥–µ –ª–µ–∂–∞—Ç —Ç—Ä—É–ø—ã

–≠—Ç–æ—Ç –ø–æ—Å—Ç –ø–æ—Å–≤—è—â–µ–Ω —Ç–µ—Å—Ç–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –ª–µ–≥–∫–æ –Ω–∞–ø–∏—Å–∞—Ç—å, –æ–±—ã—á–Ω–æ 5-8 —Å—Ç—Ä–æ–∫, –æ–Ω–∏ –ø–æ–∫—Ä—ã–≤–∞—é—Ç —Ç–µ–º–Ω—ã–µ –∏ –æ–ø–∞—Å–Ω—ã–µ —É–≥–æ–ª–∫–∏ –Ω–∞—à–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –Ω–æ —á–∞—Å—Ç–æ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –≤–Ω–∏–º–∞–Ω–∏—è.

–°–Ω–∞—á–∞–ª–∞ –Ω–µ–º–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: –∫–∞–∫ –º—ã —Ç–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—ç–∫–µ–Ω–¥? –° –ø–æ–º–æ—â—å—é [–±—Ä–∏–ª–ª–∏–∞–Ω—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](https://ritesh-kapoor.medium.com/testing-automation-what-are-pyramids-and-diamonds-67494fec7c55), –∫–æ–Ω–µ—á–Ω–æ, –¥–µ–ª–∞—è –∞–∫—Ü–µ–Ω—Ç –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã—Ö/–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –≤—Å–µ —Å–ª–æ–∏, –≤–∫–ª—é—á–∞—è —Ä–µ–∞–ª—å–Ω—É—é –ë–î. –ü—Ä–∏ —Ç–∞–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ –Ω–∞—à–∏ —Ç–µ—Å—Ç—ã –Ω–∞ 99% —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏, –∞ –æ–ø—ã—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—á—Ç–∏ —Ç–∞–∫–æ–π –∂–µ, –∫–∞–∫ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —é–Ω–∏—Ç-—Ç–µ—Å—Ç–æ–≤. –ï—Å–ª–∏ —ç—Ç–∞ —Ç–µ–º–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞, –º—ã —Ç–∞–∫–∂–µ –Ω–∞–ø–∏—Å–∞–ª–∏ [—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Å 50 –ª—É—á—à–∏–º–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –≤ Node.js](https://github.com/testjavascript/nodejs-integration-tests-best-practices).

–ù–æ –µ—Å—Ç—å –æ–¥–∏–Ω –ø–æ–¥–≤–æ–¥–Ω—ã–π –∫–∞–º–µ–Ω—å: –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–∏—à—É—Ç _—Ç–æ–ª—å–∫–æ_ –ø–æ–ª—É—Å—á–∞—Å—Ç–ª–∏–≤—ã–µ —Ç–µ—Å—Ç-–∫–µ–π—Å—ã, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–æ—Ç–æ–∫–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –≤–≤–æ–¥—ã, CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏, —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Ç. –¥. –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–ª–µ–± —Å –º–∞—Å–ª–æ–º, –æ—Ç–ª–∏—á–Ω–æ–µ –Ω–∞—á–∞–ª–æ, –Ω–æ —Ü–µ–ª–∞—è –æ–±–ª–∞—Å—Ç—å –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–ø–æ–∫—Ä—ã—Ç–æ–π.

–ù–∞–ø—Ä–∏–º–µ—Ä, —Ç–∏–ø–∏—á–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–µ –º–æ–¥–µ–ª–∏—Ä—É—é—Ç –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –ø—Ä–æ–º–∏—Å, –ø—Ä–∏–≤–æ–¥—è—â–∏–π –∫ –∞–≤–∞—Ä–∏–π–Ω–æ–º—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é –ø—Ä–æ—Ü–µ—Å—Å–∞, –Ω–µ –º–æ–¥–µ–ª–∏—Ä—É—é—Ç —Ñ–∞–∑—É –∑–∞–≥—Ä—É–∑–∫–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –Ω–µ—É–¥–∞—á–µ–π –∏ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –±–µ–∑ —Ä–∞–±–æ—Ç—ã, –∏–ª–∏ HTTP-–≤—ã–∑–æ–≤—ã –∫ –≤–Ω–µ—à–Ω–∏–º —Å–µ—Ä–≤–∏—Å–∞–º, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è —Ç–∞–π–º–∞—É—Ç–∞–º–∏ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏. –û–Ω–∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –Ω–µ –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –Ω–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –º–∞—Ä—à—Ä—É—Ç–∞, –Ω–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å OpenAPI –∫ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤, –∏ —ç—Ç–æ –ª–∏—à—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ "–º–µ—Ä—Ç–≤—ã—Ö —Ç–µ–ª", –≤—ã—Ö–æ–¥—è—â–∏—Ö –∑–∞ —Ä–∞–º–∫–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–æ–≥–¥–∞ –¥–∞–∂–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –æ—à–∏–±–∫–∞–º–∏, –∞ —Å–∫–æ—Ä–µ–µ —Å–≤—è–∑–∞–Ω—ã —Å –ø—Ä–æ—Å—Ç–æ–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

![The hidden corners](./the-hidden-corners.png)

–í–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –æ—Ç–∫—Ä—ã—Ç—å –≤–∞–º —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å —Ä–∏—Å–∫–æ–≤ –∏ –∏—Å–ø—ã—Ç–∞–Ω–∏–π

## üßü‚Äç‚ôÄÔ∏è –¢–µ—Å—Ç "–ó–æ–º–±–∏-–ø—Ä–æ—Ü–µ—Å—Å"

**üëâ–ß—Ç–æ –∏ –∫–∞–∫?**

–í–æ –≤—Å–µ—Ö —Å–≤–æ–∏—Ö —Ç–µ—Å—Ç–∞—Ö –≤—ã –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç–µ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–∂–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å, –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –ø–æ—Ç–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.

–≠—Ç–æ –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ, —Ç–∞–∫ –∫–∞–∫ –≤ —ç—Ç–æ–π —Ñ–∞–∑–µ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–±–æ–µ–≤: —Å–±–æ–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç —á–∞—Å—Ç–æ - –∑–¥–µ—Å—å –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏ –º–Ω–æ–≥–æ –Ω–µ–ø—Ä–∏—è—Ç–Ω—ã—Ö –≤–µ—â–µ–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—Ä—ã–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î –∏–ª–∏ –ø–∞–¥–µ–Ω–∏–µ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è. –ü–æ —ç—Ç–æ–π –ø—Ä–∏—á–∏–Ω–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, Kubernetes –∏ –¥—Ä—É–≥–∏–µ) –ø–æ–æ—â—Ä—è—é—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ —Å–≤–æ–µ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (—Å–º. [readiness probe](https://komodor.com/learn/kubernetes-readiness-probes-a-practical-guide/#:~:text=A%20readiness%20probe%20allows%20Kubernetes,on%20deletion%20of%20a%20pod.)).

–û—à–∏–±–∫–∏ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —Ç–∞–∫–∂–µ –æ–∫–∞–∑—ã–≤–∞—é—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è - –µ—Å–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –Ω–µ—É–¥–∞—á–Ω–æ, –∞ –ø—Ä–æ—Ü–µ—Å—Å –æ—Å—Ç–∞–ª—Å—è –∂–∏–≤, –æ–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è "–∑–æ–º–±–∏-–ø—Ä–æ—Ü–µ—Å—Å–æ–º". –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ –ø–æ–π–º–µ—Ç, —á—Ç–æ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –Ω–µ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –Ω–µ–≥–æ –∏ –Ω–µ —Å–æ–∑–¥–∞—Å—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤. –ö—Ä–æ–º–µ –∏–∑—è—â–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–∞, –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª–∏—Ä–æ–≤–∞–Ω–∏—è, —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∞ `/readiness`.

–†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —ç—Ç–æ? –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç –ø–æ–∫–∞–∂–µ—Ç!

=== "–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π –∫–æ–¥, api.js"

    ```javascript
    // A common express server initialization
    const startWebServer = () => {
    	return new Promise((resolve, reject) => {
    		try {
    			// A typical Express setup
    			expressApp = express();
    			defineRoutes(expressApp); // a function that defines all routes
    			expressApp.listen(process.env.WEB_SERVER_PORT);
    		} catch (error) {
    			//log here, fire a metric, maybe even retry and finally:
    			process.exit();
    		}
    	});
    };
    ```

=== "–¢–µ—Å—Ç"

    ```js
    // our api starter that exposes 'startWebServer' function
    const api = require('./entry-points/api');
    const sinon = require('sinon'); // a mocking library

    test(
    	'When an error happens during the startup phase,' +
    		'then the process exits',
    	async () => {
    		// Arrange
    		const processExitListener = sinon.stub(
    			process,
    			'exit'
    		);
    		// üëá Choose a function that is part of
    		// the initialization phase and make it fail
    		sinon
    			.stub(routes, 'defineRoutes')
    			.throws(
    				new Error('Cant initialize connection')
    			);

    		// Act
    		await api.startWebServer();

    		// Assert
    		expect(processExitListener.called).toBe(true);
    	}
    );
    ```

## üëÄ –¢–µ—Å—Ç –Ω–∞ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å

**üëâ –ß—Ç–æ –∏ –∑–∞—á–µ–º**

–î–ª—è –º–Ω–æ–≥–∏—Ö —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–∏–ø–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ –æ—Ç–≤–µ—Ç–∞ API. –ü—Ä–∏ —ç—Ç–æ–º –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∑–∞–º–µ—á–µ–Ω–Ω–æ–π –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö –¥–µ—Ç–∞–ª–µ–π - –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ **–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç–∏ –æ—à–∏–±–∫–∏**.

–ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è, —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞. –≠—Ç–æ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –¥–µ–ª–æ–º, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —ç—Ç–æ –∏–¥–µ—Ç –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –î–∞, –Ω–µ –∫ –∫–æ–Ω–µ—á–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –∞ –∫ –¥—Ä—É–≥–æ–º—É –≤–∞–∂–Ω–æ–º—É - –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å–≤—è–∑–∏. –ö–∞–∫–æ–≤—ã –æ–∂–∏–¥–∞–Ω–∏—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?

–ù–∞ —Å–∞–º–æ–º –±–∞–∑–æ–≤–æ–º —É—Ä–æ–≤–Ω–µ, –∫–æ–≥–¥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞, –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –≤–∏–¥–µ—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –≤ –∂—É—Ä–Ω–∞–ª–µ, –≤–∫–ª—é—á–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫—É —Å—Ç–µ–∫–∞, –ø—Ä–∏—á–∏–Ω—É –∏ –¥—Ä—É–≥–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏. –≠—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –º–æ–∂–µ—Ç —Å–ø–∞—Å—Ç–∏ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏ —Ä–µ—à–µ–Ω–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤.

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤–æ –º–Ω–æ–≥–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–µ–¥–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥ –æ–± –æ–±—â–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã, –∏—Å–ø–æ–ª—å–∑—É—è –∫—É–º—É–ª—è—Ç–∏–≤–Ω—É—é —ç–≤—Ä–∏—Å—Ç–∏–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—à–∏–±–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —á–∞—Å–∞). –î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ç–∞–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–æ–¥ —Ç–∞–∫–∂–µ –¥–æ–ª–∂–µ–Ω —Å–Ω–∏–º–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –æ—à–∏–±–æ–∫. –î–∞–∂–µ —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—ã—Ç–∞—é—Ç—Å—è –ø–æ–∫—Ä—ã—Ç—å —ç—Ç–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏, –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–∞–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –ø—Ä–æ–≤–µ—Ä—è—è, –±—ã–ª–∞ –ª–∏ –≤—ã–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –ª–æ–≥–≥–µ—Ä–∞ - –Ω–æ –≤–∫–ª—é—á–∞–µ—Ç –ª–∏ –æ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ?

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∏—à—É—Ç –±–æ–ª–µ–µ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ç–∏–ø –æ—à–∏–±–∫–∏, –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–π –≤ –ª–æ–≥–≥–µ—Ä, - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ? –ù–µ—Ç! –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–∞–∂–Ω—ã –Ω–µ –∏–º–µ–Ω–∞ –∫–ª–∞—Å—Å–æ–≤ JavaScript, –∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–µ JSON-–¥–∞–Ω–Ω—ã–µ.

–°–ª–µ–¥—É—é—â–∏–π —Ç–µ—Å—Ç —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–∞–±–ª—é–¥–∞–µ–º—ã–º–∏:

```javascript
test(
    'When exception is throw during request,' +
        ' Then logger reports the mandatory fields',
    async () => {
        //Arrange
        const orderToAdd = {
            userId: 1,
            productId: 2,
            status: 'approved',
        };
        const metricsExporterDouble = sinon.stub(
            metricsExporter,
            'fireMetric'
        );
        sinon
            .stub(OrderRepository.prototype, 'addOrder')
            .rejects(
                new AppError(
                    'saving-failed',
                    'Order could not be saved',
                    500
                )
            );
        const loggerDouble = sinon.stub(logger, 'error');

        //Act
        await axiosAPIClient.post('/order', orderToAdd);

        //Assert
        expect(loggerDouble).toHaveBeenCalledWith({
            name: 'saving-failed',
            status: 500,
            stack: expect.any(String),
            message: expect.any(String),
        });
        expect(metricsExporterDouble).toHaveBeenCalledWith(
            'error',
            {
                errorName: 'example-error',
            }
        );
    }
);
```

## üëΩ –¢–µ—Å—Ç "–Ω–µ–∂–¥–∞–Ω–Ω—ã–π –≥–æ—Å—Ç—å" - –∫–æ–≥–¥–∞ –≤ –Ω–∞—à–µ–º –∫–æ–¥–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –Ω–µ –ø–æ–π–º–∞–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ

**üëâ –ß—Ç–æ –∏ –ø–æ—á–µ–º—É**

–¢–∏–ø–∏—á–Ω—ã–π —Ç–µ—Å—Ç –ø–æ—Ç–æ–∫–∞ –æ—à–∏–±–æ–∫ –æ—à–∏–±–æ—á–Ω–æ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –¥–≤–∞ —É—Å–ª–æ–≤–∏—è: –ë—ã–ª –±—Ä–æ—à–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç –æ—à–∏–±–∫–∏, –∏ –æ–Ω –±—ã–ª –ø–æ–π–º–∞–Ω. –ù–∏ —Ç–æ, –Ω–∏ –¥—Ä—É–≥–æ–µ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ, –¥–∞–≤–∞–π—Ç–µ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏–º—Å—è –Ω–∞ –≤—Ç–æ—Ä–æ–º –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–∏: —á–∞—Å—Ç–æ –±—ã–≤–∞–µ—Ç, —á—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ—à–∏–±–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–µ –ø–æ–π–º–∞–Ω–Ω—ã–º–∏.

–û—à–∏–±–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–±—Ä–æ—à–µ–Ω–∞ –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –≤–∞—à–µ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ npm –º–æ–≥—É—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–µ–∫–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–∞–π–º–µ—Ä–∞, –∏–ª–∏ –≤—ã –ø—Ä–æ—Å—Ç–æ –∑–∞–±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `someEventEmitter.on('error', ...)`.

–≠—Ç–æ –ª–∏—à—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤. –≠—Ç–∏ –æ—à–∏–±–∫–∏ –ø–æ–ø–∞–¥—É—Ç –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `process.on('uncaughtException')`, **–Ω–∞–¥–µ–µ–º—Å—è, –≤–∞—à –∫–æ–¥ –Ω–∞ –Ω–∏—Ö –ø–æ–¥–ø–∏—Å–∞–ª—Å—è**.

–ö–∞–∫ —Å–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π –≤ —Ç–µ—Å—Ç–µ? –ù–∞–∏–≤–Ω–æ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —É—á–∞—Å—Ç–æ–∫ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –æ–±–µ—Ä–Ω—É—Ç try-catch, –∏ –∑–∞–≥–ª—É—à–∏—Ç—å (stub) –µ–≥–æ, —á—Ç–æ–±—ã –±—Ä–æ—Å–∏—Ç—å (throw) –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∞. –ù–æ —Ç—É—Ç –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∑–∞–≥–≤–æ–∑–¥–∫–∞: –µ—Å–ª–∏ –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å —Ç–∞–∫–æ–π –æ–±–ª–∞—Å—Ç—å—é, —Ç–æ, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –≤—ã –±—É–¥–µ—Ç–µ –µ–µ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å –∏ —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Ç–µ–º, —á—Ç–æ–±—ã –µ–µ –æ—à–∏–±–∫–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–ª–∏—Å—å.

–ß—Ç–æ –∂–µ –¥–µ–ª–∞—Ç—å? –ú–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–µ–º, —á—Ç–æ JavaScript "–Ω–µ –∏–º–µ–µ—Ç –≥—Ä–∞–Ω–∏—Ü", –µ—Å–ª–∏ –∫–∞–∫–æ–π-—Ç–æ –æ–±—ä–µ–∫—Ç –º–æ–∂–µ—Ç –∏—Å–ø—É—Å–∫–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ, —Ç–æ –º—ã, –∫–∞–∫ –µ–≥–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏, –º–æ–∂–µ–º —Å–∞–º–∏ –∑–∞—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –∏—Å–ø—É—Å–∫–∞—Ç—å —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ, –≤–æ—Ç –ø—Ä–∏–º–µ—Ä:

```javascript
test(
    'When an unhandled exception is thrown,' +
        ' then process stays alive and the error is logged',
    async () => {
        //Arrange
        const loggerDouble = sinon.stub(logger, 'error');
        const processExitListener = sinon.stub(
            process,
            'exit'
        );
        const errorToThrow = new Error(
            'An error that wont be caught üò≥'
        );

        //Act
        //üëà Where the magic is
        process.emit('uncaughtException', errorToThrow);

        // Assert
        expect(processExitListener.called).toBe(false);
        expect(loggerDouble).toHaveBeenCalledWith(
            errorToThrow
        );
    }
);
```

## üïµüèº –¢–µ—Å—Ç –Ω–∞ "—Å–∫—Ä—ã—Ç—ã–π —ç—Ñ—Ñ–µ–∫—Ç" - –∫–æ–≥–¥–∞ –∫–æ–¥ –Ω–µ –¥–æ–ª–∂–µ–Ω –º—É—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–æ–æ–±—â–µ

**üëâ–ß—Ç–æ –∏ –∫–∞–∫**

–í —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã–π –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è —Ä–∞–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –≤—Ö–æ–¥—è—â–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –∏–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏. –í —ç—Ç–∏—Ö —Å–ª—É—á–∞—è—Ö –Ω–∏–∫–∞–∫–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã.

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ç–æ–ª—å–∫–æ HTTP-–æ—Ç–≤–µ—Ç–∞ - –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç–≤–µ—Ç HTTP 400? –û—Ç–ª–∏—á–Ω–æ, –≤–∞–ª–∏–¥–∞—Ü–∏—è/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –≤–µ—Ä–æ—è—Ç–Ω–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç. –ò–ª–∏ –Ω–µ—Ç? –¢–µ—Å—Ç —Å–ª–∏—à–∫–æ–º –¥–æ–≤–µ—Ä—è–µ—Ç –∫–æ–¥—É, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–æ–¥, –ª–µ–∂–∞—â–∏–π –≤ –æ—Å–Ω–æ–≤–µ, –≤–µ–¥–µ—Ç —Å–µ–±—è —Ç–∞–∫, –∫–∞–∫ –∑–∞–¥—É–º–∞–Ω–æ. –ú–æ–∂–µ—Ç –±—ã—Ç—å, –±—ã–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å, —Ö–æ—Ç—è —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –ø—Ä–∞–≤? –û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ —ç—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–æ –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∑–∞–ø–∏—Å—å –ù–ï –±—ã–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞?

–ó–¥–µ—Å—å –≤–æ–∑–º–æ–∂–Ω—ã –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞: –ï—Å–ª–∏ –ë–î –æ—á–∏—â–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥/–ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞, —Ç–æ –ø—Ä–æ—Å—Ç–æ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ë–î –ø—É—Å—Ç–∞. –ï—Å–ª–∏ –∂–µ –≤—ã —á–∏—Å—Ç–∏—Ç–µ –ë–î –Ω–µ —á–∞—Å—Ç–æ (–∫–∞–∫ —è, –Ω–æ —ç—Ç–æ —É–∂–µ –¥—Ä—É–≥–∞—è —Ç–µ–º–∞), —Ç–æ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –ø–æ–∑–∂–µ –∏ –Ω–∞–¥–µ—è—Ç—å—Å—è, —á—Ç–æ –∑–∞–ø–∏—Å–µ–π –Ω–µ –±—É–¥–µ—Ç. –í–æ—Ç –∫–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç:

```javascript
it(
    'When adding an invalid order,' +
        ' then it returns 400 and NOT retrievable',
    async () => {
        //Arrange
        const orderToAdd = {
            userId: 1,
            mode: 'draft',
            externalIdentifier: uuid(), //no existing record has this value
        };

        //Act
        const {
            status: addingHTTPStatus,
        } = await axiosAPIClient.post('/order', orderToAdd);

        //Assert
        const {
            status: fetchingHTTPStatus,
        } = await axiosAPIClient.get(
            `/order/externalIdentifier/${orderToAdd.externalIdentifier}`
        ); // Trying to get the order that should have failed
        expect({
            addingHTTPStatus,
            fetchingHTTPStatus,
        }).toMatchObject({
            addingHTTPStatus: 400,
            fetchingHTTPStatus: 404,
        });
        // üëÜ Check that no such record exists
    }
);
```

## üß® –¢–µ—Å—Ç "–ø–µ—Ä–µ–±–æ—Ä—â–∏–ª" - –∫–æ–≥–¥–∞ –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –º—É—Ç–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ –¥–µ–ª–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ.

**üëâ –ß—Ç–æ –∏ –ø–æ—á–µ–º—É**

–í–æ—Ç –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∏–ø–∏—á–Ω—ã–π —Ç–µ—Å—Ç, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –¥–∞–Ω–Ω—ã–µ: —Å–Ω–∞—á–∞–ª–∞ –≤—ã –¥–æ–±–∞–≤–ª—è–µ—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π, –∑–∞—Ç–µ–º –æ–±—Ä–∞—â–∞–µ—Ç–µ—Å—å –∫ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–º—É –∫–æ–¥—É, –∏, –Ω–∞–∫–æ–Ω–µ—Ü, —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å —ç—Ç–∏–º–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏. –ü–æ–∫–∞ –≤—Å–µ —Ö–æ—Ä–æ—à–æ.

–û–¥–Ω–∞–∫–æ –∑–¥–µ—Å—å –µ—Å—Ç—å –æ–¥–Ω–∞ –æ–≥–æ–≤–æ—Ä–∫–∞: –ø–æ—Å–∫–æ–ª—å–∫—É —Ç–µ—Å—Ç —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å—è—Ö, –æ–Ω –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç, –±—ã–ª–∏ –ª–∏ –∏–∑–ª–∏—à–Ω–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã –¥—Ä—É–≥–∏–µ –∑–∞–ø–∏—Å–∏.

–≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ, –≤–æ—Ç –∫–æ—Ä–æ—Ç–∫–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–∏–∑–æ—à–ª–∞ —Å –º–æ–∏–º –∫–ª–∏–µ–Ω—Ç–æ–º: –≤ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –±—ã–ª–∏ –≤–Ω–µ—Å–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤–µ–ª–∏ –∫ –æ—à–∏–±–∫–µ, –æ–±–Ω–æ–≤–ª—è—é—â–µ–π –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–∏—Å—Ç–µ–º—ã, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ. –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã.

–ö–∞–∫ –±—ã –≤—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏–ª–∏ —ç—Ç–æ? –í–æ—Ç —Ö–æ—Ä–æ—à–∏–π –ø—Ä–∏–µ–º, –∫–æ—Ç–æ—Ä–æ–º—É –º–µ–Ω—è –Ω–∞—É—á–∏–ª –º–æ–π –¥—Ä—É–≥ –ì–∏–ª –¢–∞–π–∞—Ä: –Ω–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–ø–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ–º–∏–º–æ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π, –¥–æ–±–∞–≤—å—Ç–µ –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ "–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö" –∑–∞–ø–∏—Å–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –∏–∑–º–µ–Ω—è—Ç—å—Å—è –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ó–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã–π –∫–æ–¥ –∏, –ø–æ–º–∏–º–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –Ω–µ –ø–æ—Å—Ç—Ä–∞–¥–∞–ª–∏:

```javascript
test(
    'When deleting an existing order,' +
        ' Then it should NOT be retrievable',
    async () => {
        // Arrange
        const orderToDelete = {
            userId: 1,
            productId: 2,
        };
        const deletedOrder = (
            await axiosAPIClient.post(
                '/order',
                orderToDelete
            )
        ).data.id; // We will delete this soon
        const orderNotToBeDeleted = orderToDelete;
        const notDeletedOrder = (
            await axiosAPIClient.post(
                '/order',
                orderNotToBeDeleted
            )
        ).data.id; // We will not delete this

        // Act
        await axiosAPIClient.delete(
            `/order/${deletedOrder}`
        );

        // Assert
        const {
            status: getDeletedOrderStatus,
        } = await axiosAPIClient.get(
            `/order/${deletedOrder}`
        );
        const {
            status: getNotDeletedOrderStatus,
        } = await axiosAPIClient.get(
            `/order/${notDeletedOrder}`
        );
        expect(getNotDeletedOrderStatus).toBe(200);
        expect(getDeletedOrderStatus).toBe(404);
    }
);
```

## üï∞ –¢–µ—Å—Ç "–º–µ–¥–ª–µ–Ω–Ω—ã–π –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–æ—Ä" - –∫–æ–≥–¥–∞ –¥—Ä—É–≥–æ–π HTTP-—Å–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø–µ—Ä–µ–±–æ—è–º–∏

**üëâ –ß—Ç–æ –∏ –∑–∞—á–µ–º**

–ö–æ–≥–¥–∞ –≤–∞—à –∫–æ–¥ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –¥—Ä—É–≥–∏–º —Å–µ—Ä–≤–∏—Å–∞–º/–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º –ø–æ HTTP, –æ–ø—ã—Ç–Ω—ã–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫–∏ —Å–≤–æ–¥—è—Ç –∫ –º–∏–Ω–∏–º—É–º—É —Å–∫–≤–æ–∑–Ω—ã–µ —Ç–µ—Å—Ç—ã, —Ç–∞–∫ –∫–∞–∫ –≤ —ç—Ç–∏—Ö —Ç–µ—Å—Ç–∞—Ö –ø—Ä–æ—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è –∫ —Å—á–∞—Å—Ç–ª–∏–≤—ã–º –ø—É—Ç—è–º (—Å–ª–æ–∂–Ω–µ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏).

–≠—Ç–æ –æ–±—è–∑—ã–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫–æ–π-–ª–∏–±–æ mocking-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —á—Ç–æ–±—ã –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∫–∞–∫ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ–º–æ—â—å—é —Ç–∞–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –∫–∞–∫ [nock](https://github.com/nock/nock) –∏–ª–∏ [wiremock](https://wiremock.org/). –≠—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ö–æ—Ä–æ—à–∏, —Ç–æ–ª—å–∫–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏—Ö –Ω–∞–∏–≤–Ω–æ –∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ç–æ, —á—Ç–æ –≤—ã–∑–æ–≤—ã –∏–∑–≤–Ω–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –±—ã–ª–∏ —Å–¥–µ–ª–∞–Ω—ã. –ê —á—Ç–æ –µ—Å–ª–∏ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω **–≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ**, —á—Ç–æ –µ—Å–ª–∏ –æ–Ω –º–µ–¥–ª–µ–Ω–Ω–µ–µ –∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ —Å—Ç—Ä–æ—è (–æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –±–æ–ª—å—à–∏—Ö —Ä–∏—Å–∫–æ–≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤)?

–•–æ—Ç—è –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–ø–∞—Å—Ç–∏ —ç—Ç—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, –≤–∞—à –∫–æ–¥ –¥–æ–ª–∂–µ–Ω —Å–¥–µ–ª–∞—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ–µ –≤ –¥–∞–Ω–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É, –∏–ª–∏, –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –≤—ã–∑—ã–≤–∞—é—â–µ–º—É —Å–µ—Ä–≤–∏—Å—É. –í—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–µ—Ç–µ–≤–æ–≥–æ –º–æ–∫–∏–Ω–≥–∞ –ø–æ–∑–≤–æ–ª—è—é—Ç –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏, —Ç–∞–π–º–∞—É—Ç—ã –∏ –¥—Ä—É–≥–∏–µ "—Ö–∞–æ—Ç–∏—á–Ω—ã–µ" —Å—Ü–µ–Ω–∞—Ä–∏–∏. –û—Å—Ç–∞–µ—Ç—Å—è –≤–æ–ø—Ä–æ—Å, –∫–∞–∫ –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫, –Ω–µ —Å–æ–∑–¥–∞–≤–∞—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤?

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [fake timers](https://sinonjs.org/releases/latest/fake-timers/) –∏ –æ–±–º–∞–Ω—É—Ç—å —Å–∏—Å—Ç–µ–º—É, –∑–∞—Å—Ç–∞–≤–∏–≤ –µ–µ –ø–æ–≤–µ—Ä–∏—Ç—å –≤ —Ç–æ, —á—Ç–æ –∑–∞ –æ–¥–∏–Ω —Ç–∏–∫ –ø—Ä–æ—à–ª–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥. –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ [nock](https://github.com/nock/nock), —Ç–æ –æ–Ω –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–π–º–∞—É—Ç—ã **–±—ã—Å—Ç—Ä–æ**: —Ñ—É–Ω–∫—Ü–∏—è `.delay` –∏–º–∏—Ç–∏—Ä—É–µ—Ç –º–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç, –ø–æ—Å–ª–µ —á–µ–≥–æ nock —Å—Ä–∞–∑—É –ø–æ–π–º–µ—Ç, —á—Ç–æ –∑–∞–¥–µ—Ä–∂–∫–∞ –±–æ–ª—å—à–µ, —á–µ–º —Ç–∞–π–º–∞—É—Ç HTTP-–∫–ª–∏–µ–Ω—Ç–∞, –∏ —Å—Ä–∞–∑—É, –Ω–µ –¥–æ–∂–∏–¥–∞—è—Å—å, –≤—ã–±—Ä–æ—Å–∏—Ç —Å–æ–±—ã—Ç–∏–µ —Ç–∞–π–º–∞—É—Ç–∞

```javascript
// In this example, our code accepts new Orders
// and while processing them approaches the Users Microservice
test(
    'When users service times out,' +
        ' then return 503 (option 1 with fake timers)',
    async () => {
        //Arrange
        const clock = sinon.useFakeTimers();
        // Set a timeout for outgoing HTTP calls
        config.HTTPCallTimeout = 1000;
        nock(`${config.userServiceURL}/user/`)
            // Reply delay is bigger than configured timeout üëÜ
            .get('/1', () => clock.tick(2000))
            .reply(200);
        const loggerDouble = sinon.stub(logger, 'error');
        const orderToAdd = {
            userId: 1,
            productId: 2,
            mode: 'approved',
        };

        //Act
        // üëátry to add new order which should fail
        // due to User service not available
        const response = await axiosAPIClient.post(
            '/order',
            orderToAdd
        );

        //Assert
        // üëáAt least our code does its best given this situation
        expect(response.status).toBe(503);
        expect(
            loggerDouble.lastCall.firstArg
        ).toMatchObject({
            name: 'user-service-not-available',
            stack: expect.any(String),
            message: expect.any(String),
        });
    }
);
```

## üíä –¢–µ—Å—Ç –Ω–∞ "–æ—Ç—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ" - –∫–æ–≥–¥–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—É—á–∞–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –µ–≥–æ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ç–∞–≥–Ω–∞—Ü–∏–∏

**üëâ –ß—Ç–æ –∏ –∫–∞–∫**

–ü—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è –∏–ª–∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è –æ—á–µ—Ä–µ–¥—å—é, –≤—ã –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å –æ–±–æ–π—Ç–∏ —Å–ª–æ–π –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π, –≥–¥–µ –∫–æ–¥ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ø–æ—Ç—Ä–µ–±–ª—è—é—Ç –æ—á–µ—Ä–µ–¥—å, –∏ –æ–±—Ä–∞—â–∞–µ—Ç–µ—Å—å –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∫ –ª–æ–≥–∏—á–µ—Å–∫–æ–º—É —Å–ª–æ—é.

–î–∞, —ç—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –∑–∞–¥–∞—á—É, –Ω–æ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å –Ω–µ–ø—Ä–∏–∫—Ä—ã—Ç—ã—Ö —Ä–∏—Å–∫–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ –µ—Å–ª–∏ –ª–æ–≥–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å –≤—ã–∫–∏–Ω–µ—Ç –æ—à–∏–±–∫—É –∏–ª–∏ —Å—Ö–µ–º–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–∫–∞–∂–µ—Ç—Å—è –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π, –∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ —Å–º–æ–∂–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —ç—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π?

–ù–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–¥ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è –º–æ–∂–µ—Ç –Ω–µ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –æ—á–µ—Ä–µ–¥–∏). –ö–æ–≥–¥–∞ —ç—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ø–∞–¥–µ—Ç –≤ —Ü–∏–∫–ª, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–æ –±—É–¥–µ—Ç –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å—Å—è —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞. –ü–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫–æ –º–Ω–æ–≥–∏–º —Å–æ–æ–±—â–µ–Ω–∏—è–º, —Å–∏—Ç—É–∞—Ü–∏—è –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ–π, —Ç–∞–∫ –∫–∞–∫ –æ—á–µ—Ä–µ–¥—å –±—É–¥–µ—Ç —Å–∏–ª—å–Ω–æ –ø–µ—Ä–µ–Ω–∞—Å—ã—â–µ–Ω–∞.

–ü–æ —ç—Ç–æ–π –ø—Ä–∏—á–∏–Ω–µ –¥–∞–Ω–Ω—ã–π —Å–∏–Ω–¥—Ä–æ–º –ø–æ–ª—É—á–∏–ª –Ω–∞–∑–≤–∞–Ω–∏–µ "–æ—Ç—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ". –ß—Ç–æ–±—ã —Å–Ω–∏–∑–∏—Ç—å —ç—Ç–æ—Ç —Ä–∏—Å–∫, –æ–±–ª–∞—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏—è —Ç–µ—Å—Ç–æ–≤ –¥–æ–ª–∂–Ω–∞ –≤–∫–ª—é—á–∞—Ç—å –≤—Å–µ —É—Ä–æ–≤–Ω–∏, –∫–∞–∫ —ç—Ç–æ, –≤–µ—Ä–æ—è—Ç–Ω–æ, –¥–µ–ª–∞–µ—Ç—Å—è –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ API. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ –Ω–µ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ, –∫–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ë–î, –ø–æ—Å–∫–æ–ª—å–∫—É –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã, –∏ –≤–æ—Ç –ø–æ—á–µ–º—É.

–ü—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –æ—á–µ—Ä–µ–¥—è–º–∏ –≤—Å–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –µ—â–µ –±–æ–ª–µ–µ –ª—é–±–æ–ø—ã—Ç–Ω—ã–º: —Ç–µ—Å—Ç—ã –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –±—É–¥—É—Ç –∫—Ä–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –¥—Ä—É–≥ —É –¥—Ä—É–≥–∞, –æ—á–∏—â–∞—Ç—å –æ—á–µ—Ä–µ–¥–∏ —Å–ª–æ–∂–Ω–µ–µ, —á–µ–º –≤—ã –¥—É–º–∞–µ—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, [SQS —Ç—Ä–µ–±—É–µ—Ç 60 —Å–µ–∫—É–Ω–¥](https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-using-purge-queue.html) –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–µ–π), –∏ —ç—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–±–ª–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –Ω–µ –≤—Å—Ç—Ä–µ—Ç–∏—Ç–µ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î.

–í–æ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –º–Ω–æ–≥–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö –∏ —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–±–æ–ª—å—à–∏–º –∫–æ–º–ø—Ä–æ–º–∏—Å—Å–æ–º - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–ª—å—à–∏–≤—É—é –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π in-memory. –ü–æ–¥ "–ø–æ–¥–¥–µ–ª–∫–æ–π" —è –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞—é –Ω–µ—á—Ç–æ –ø—Ä–æ—Å—Ç–æ–µ, —á—Ç–æ –¥–µ–π—Å—Ç–≤—É–µ—Ç –∫–∞–∫ –∑–∞–≥–ª—É—à–∫–∞/—à–ø–∏–æ–Ω –∏ –Ω–µ –¥–µ–ª–∞–µ—Ç –Ω–∏—á–µ–≥–æ, –∫—Ä–æ–º–µ –∫–∞–∫ —Å–æ–æ–±—â–∞–µ—Ç, –∫–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ, –ø—É–±–ª–∏–∫–∞—Ü–∏—è).

–í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –ø–æ–¥–¥–µ–ª–∫–∏/—à–ª–µ–π—Ñ—ã –¥–ª—è –≤–∞—à–µ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä [—ç—Ç–æ—Ç –¥–ª—è SQS](https://github.com/m-radzikowski/aws-sdk-client-mock), –∏ –≤—ã –º–æ–∂–µ—Ç–µ —Å–∞–º–∏ **–ª–µ–≥–∫–æ** –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–∞–∫–æ–π. –ù–µ –±–µ—Å–ø–æ–∫–æ–π—Ç–µ—Å—å, —è –Ω–µ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–∫ —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–∞–º–æ–º—É –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–µ–¥–µ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç –∏ –≤—Ä—è–¥ –ª–∏ –ø—Ä–µ–≤—ã—Å–∏—Ç 50 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ (—Å–º. –ø—Ä–∏–º–µ—Ä –Ω–∏–∂–µ).

–í –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —ç—Ç–æ–º—É, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –Ω–∞—Å—Ç–æ—è—â–∞—è –∏–ª–∏ —Ñ–∞–ª—å—à–∏–≤–∞—è –æ—á–µ—Ä–µ–¥—å, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —Å–æ–æ–±—â–∞—é—â–∏–π —Ç–µ—Å—Ç—É, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏–∑–æ—à–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –±—ã–ª–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ/—É–¥–∞–ª–µ–Ω–æ –∏–ª–∏ –±—ã–ª–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. –ë–µ–∑ —ç—Ç–æ–≥–æ —Ç–µ—Å—Ç –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É–∑–Ω–∞–µ—Ç, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏–∑–æ—à–ª–∏ —Ç–µ –∏–ª–∏ –∏–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è, –∏ –±—É–¥–µ—Ç —Å–∫–ª–æ–Ω—è—Ç—å—Å—è –∫ —Ç–∞–∫–∏–º –ø—Ä–∏—á—É–¥–ª–∏–≤—ã–º –º–µ—Ç–æ–¥–∞–º, –∫–∞–∫ –æ–ø—Ä–æ—Å.

–ü—Ä–∏ —Ç–∞–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Ç–µ—Å—Ç –±—É–¥–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–º, –ø–ª–æ—Å–∫–∏–º –∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫–∏–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ä–∞–±–æ—Ç—ã –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–∞–∫ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø–æ –ø–æ—Ä—è–¥–∫—É, –ø–∞–∫–µ—Ç–Ω—ã–π –æ—Ç–∫–∞–∑, –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π, –∞ –≤ –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ - —Å—Ü–µ–Ω–∞—Ä–∏–π –æ—Ç—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ RabbitMQ):

1.  –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–¥–¥–µ–ª—å–Ω—É—é –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç, –∫—Ä–æ–º–µ –∑–∞–ø–∏—Å–∏ –æ–±—Ä–∞—â–µ–Ω–∏–π, –ø–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å–º. –∑–¥–µ—Å—å

    ```javascript
    class FakeMessageQueueProvider extends EventEmitter {
        // Implement here

        publish(message) {}

        consume(queueName, callback) {}
    }
    ```

2.  –ó–∞—Å—Ç–∞–≤—å—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞ –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏–ª–∏ —Ñ–∞–ª—å—à–∏–≤–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (–ø—Ä–∏–º–µ—Ä [–ø—Ä–æ—Å—Ç–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](https://github.com/testjavascript/nodejs-integration-tests-best-practices/blob/master/example-application/libraries/fake-message-queue-provider.js)):

    ```javascript
    class MessageQueueClient extends EventEmitter {
        // Pass to it a fake or real message queue
        constructor(customMessageQueueProvider) {}

        publish(message) {}

        consume(queueName, callback) {}
    }
    ```

3.  –í—ã–≤–µ—Å—Ç–∏ —É–¥–æ–±–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–æ–±—â–∞–µ—Ç, –∫–æ–≥–¥–∞ –±—ã–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã

    ```javascript
    class MessageQueueClient extends EventEmitter {
    	publish(message) {}

    	consume(queueName, callback) {}

    	// üëá
    	waitForEvent(
    		eventName: 'publish' | 'consume' | 'acknowledge' | 'reject',
    		howManyTimes: number
    	) : Promise
    }
    ```

4.  –¢–µ—Å—Ç —Å—Ç–∞–ª –∫–æ—Ä–æ—Ç–∫–∏–º, —Ä–æ–≤–Ω—ã–º –∏ –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã–º üëá

    ```js
    const FakeMessageQueueProvider = require('./libs/fake-message-queue-provider');
    const MessageQueueClient = require('./libs/message-queue-client');
    const newOrderService = require('./domain/newOrderService');

    test(
        'When a poisoned message arrives,' +
            ' then it is being rejected back',
        async () => {
            // Arrange
            const messageWithInvalidSchema = {
                nonExistingProperty: 'invalid‚ùå',
            };
            const messageQueueClient = new MessageQueueClient(
                new FakeMessageQueueProvider()
            );
            // Subscribe to new messages and passing the handler function
            messageQueueClient.consume(
                'orders.new',
                newOrderService.addOrder
            );

            // Act
            await messageQueueClient.publish(
                'orders.new',
                messageWithInvalidSchema
            );
            // Now all the layers of the app will get stretched üëÜ,
            // including logic and message queue libraries

            // Assert
            await messageQueueClient.waitFor('reject', {
                howManyTimes: 1,
            });
            // üëÜ This tells us that eventually our code asked
            // the message queue client to reject this poisoned message
        }
    );
    ```

üìù –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ [–Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–¥–µ—Å—å](https://github.com/testjavascript/nodejs-integration-tests-best-practices/blob/master/recipes/message-queue/fake-message-queue.test.js)

## üì¶ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞ –∫–∞–∫ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è

**üëâ–ß—Ç–æ –∏ –ø–æ—á–µ–º—É**

–ü—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–∞ npm, –≤—Å–µ –≤–∞—à–∏ —Ç–µ—Å—Ç—ã –º–æ–≥—É—Ç –ø—Ä–æ–π—Ç–∏, –Ω–æ... –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —ç—Ç–∞ –∂–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å. –ö–∞–∫ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç? –¢–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞–¥ –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –∞ –∫–æ–Ω–µ—á–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —Å–æ–±—Ä–∞–Ω—ã.

–í–∏–¥–∏—Ç–µ –ª–∏ –≤—ã –∑–¥–µ—Å—å –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ? –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ —Ñ–∞–π–ª—ã –ø–∞–∫–µ—Ç–∞ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä—É—é—Ç—Å—è (—è —Å–º–æ—Ç—Ä—é –Ω–∞ –≤–∞—Å, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ babel), –∑–∞–ø–µ—á–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏ —É–ø–∞–∫–æ–≤—ã–≤–∞—é—Ç—Å—è. –ï—Å–ª–∏ —Ö–æ—Ç—å –æ–¥–∏–Ω —Ñ–∞–π–ª –∏—Å–∫–ª—é—á–µ–Ω –∏–∑-–∑–∞ .npmignore –∏–ª–∏ –ø–æ–ª–∏—Ñ–∏–ª–ª –¥–æ–±–∞–≤–ª–µ–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —Ç–æ –≤ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–º –∫–æ–¥–µ –±—É–¥—É—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–ª–µ–¥—É—é—â–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π: –≤—ã —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –∏ –Ω–∞–ø–∏—Å–∞–ª–∏ —Ç–∞–∫–æ–π –∫–æ–¥:

```js
// index.js
export * from './calculate.js';

// calculate.js üëà
export function calculate() {
    return 1;
}
```

–ó–∞—Ç–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤:

```js
import { calculate } from './index.js';

test('should return 1', () => {
  expect(calculate()).toBe(1);
})

‚úÖ All tests pass üéä
```

–ù–∞–∫–æ–Ω–µ—Ü, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `package.json`:

```json
{
    // ....
    "files": ["index.js"]
}
```

–í–∏–¥–∏—Ç–µ, –ø–æ–∫—Ä—ã—Ç–∏–µ 100%, –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ –∏ –≤ CI ‚úÖ, —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —ç—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç üëπ. –ü–æ—á–µ–º—É? –ü–æ—Ç–æ–º—É —á—Ç–æ –≤—ã –∑–∞–±—ã–ª–∏ –≤–∫–ª—é—á–∏—Ç—å `calculate.js` –≤ –º–∞—Å—Å–∏–≤ `—Ñ–∞–π–ª–æ–≤` package.json üëÜ.

–ß—Ç–æ –º—ã –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ? –ú—ã –º–æ–∂–µ–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ _–µ–µ –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π_. –ö–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å? –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ä–µ–µ—Å—Ç—Ä–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä [verdaccio](https://verdaccio.org/), –ø–æ–∑–≤–æ–ª–∏—Ç—å —Ç–µ—Å—Ç–∞–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ _–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–º—É_ –∫–æ–¥—É. –ó–≤—É—á–∏—Ç —Ö–ª–æ–ø–æ—Ç–Ω–æ? –°—É–¥–∏—Ç–µ —Å–∞–º–∏ üëá.

```js
// global-setup.js

// 1. Setup the in-memory NPM registry, one function that's it! üî•
await setupVerdaccio();

// 2. Building our package
await exec('npm', ['run', 'build'], {
    cwd: packagePath,
});

// 3. Publish it to the in-memory registry
await exec(
    'npm',
    ['publish', '--registry=http://localhost:4873'],
    {
        cwd: packagePath,
    }
);

// 4. Installing it in the consumer directory
await exec(
    'npm',
    [
        'install',
        'my-package',
        '--registry=http://localhost:4873',
    ],
    {
        cwd: consumerPath,
    }
);

// Test file in the consumerPath

// 5. Test the package üöÄ
test('should succeed', async () => {
    const { fn1 } = await import('my-package');

    expect(fn1()).toEqual(1);
});
```

üìù –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ [–Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–¥–µ—Å—å](https://github.com/rluvaton/e2e-verdaccio-example)

–î–ª—è —á–µ–≥–æ –µ—â–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–∞ —ç—Ç–∞ —Ç–µ—Ö–Ω–∏–∫–∞?

-   –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–µ—Ä—Å–∏–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –≤–∞–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π - –¥–æ–ø—É—Å—Ç–∏–º, –≤–∞—à –ø–∞–∫–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–∞–∫—Ü–∏—é 16-18, —Ç–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ.
-   –í—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π ESM –∏ CJS.
-   –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å CLI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Å–≤–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
-   –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –≤—Å—è –º–∞–≥–∏—è –≤—É–¥—É –≤ —Ñ–∞–π–ª–µ babel —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫, –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è

## üóû –¢–µ—Å—Ç "–Ω–∞—Ä—É—à–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞" - –∫–æ–≥–¥–∞ –∫–æ–¥ –≤–µ–ª–∏–∫–æ–ª–µ–ø–µ–Ω, –Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è OpenAPI –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—à–∏–±–∫–µ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ

**üëâ–ß—Ç–æ –∏ –∫–∞–∫**

–° –ø–æ–ª–Ω–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é –º–æ–≥—É —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–∏ –æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–≤–æ–µ–≥–æ OpenAPI. "–≠—Ç–æ –ø—Ä–æ—Å—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è", "–º—ã –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –µ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–¥–∞" - —Ç–∏–ø–∏—á–Ω—ã–µ —É–±–µ–∂–¥–µ–Ω–∏—è, –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è –ø–æ —ç—Ç–æ–π –ø—Ä–∏—á–∏–Ω–µ. –°–µ–π—á–∞—Å —è –ø–æ–∫–∞–∂—É –≤–∞–º, –∫–∞–∫ —ç—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—à–∏–±–æ—á–Ω–æ–π –∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –Ω–µ —Ç–æ–ª—å–∫–æ –∫ —Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏—é, –Ω–æ –∏ –∫ –æ—à–∏–±–∫–µ. –í –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–ª–µ–¥—É—é—â–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π: –≤–∞—Å –ø–æ–ø—Ä–æ—Å–∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∫–æ–¥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ—à–∏–±–∫–∏ HTTP, –µ—Å–ª–∏ –∑–∞–∫–∞–∑ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –∑–∞–±—ã–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é OpenAPI —Å —ç—Ç–∏–º –Ω–æ–≤—ã–º –æ—Ç–≤–µ—Ç–æ–º –Ω–∞ —Å—Ç–∞—Ç—É—Å HTTP. –í —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ –º–æ–≥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏, –Ω–∏ –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö –Ω–µ –º–æ–∂–µ—Ç –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ –æ—à–∏–±–∫–∏ –≤—ã–¥–∞–µ—Ç –≤–∞—à –∫–æ–¥, —ç—Ç–æ—Ç —Ç—Ä—É–¥ –≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é.

–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –∫–ª–∏–µ–Ω—Ç API –¥–µ–ª–∞–µ—Ç –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É—è—Å—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–π –≤–∞–º–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–µ–π, –¥–æ–±–∞–≤–ª—è—è –∑–∞–∫–∞–∑—ã —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –ø–æ—Ç–æ–º—É —á—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–µ –∑–∞–ø—Ä–µ—â–∞–µ—Ç —ç—Ç–æ–≥–æ –¥–µ–ª–∞—Ç—å. –ò —Ç—É—Ç - –ë–£–ú, –æ—à–∏–±–∫–∞ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ -> –∫–ª–∏–µ–Ω—Ç –ø–∞–¥–∞–µ—Ç –∏ –≤—ã–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —É—Ä–æ–¥–ª–∏–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–π –æ—à–∏–±–∫–µ.

–≠—Ç–æ—Ç —Ç–∏–ø —Å–±–æ—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–æ–π "–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞", –∫–æ–≥–¥–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç –¥–≤–µ —Å—Ç–æ—Ä–æ–Ω—ã, —É –∫–∞–∂–¥–æ–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ, –ø—Ä–æ—Å—Ç–æ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ —Ä–∞–∑–Ω—ã–º —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è–º –∏ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è–º. –•–æ—Ç—è —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ø—Ä–∏—á—É–¥–ª–∏–≤—ã–µ –∏ –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∏–µ —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, [PACT](https://pact.io)), –µ—Å—Ç—å –∏ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–µ –ø–æ–¥—Ö–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É _–ª–µ–≥–∫–æ –∏ –±—ã—Å—Ç—Ä–æ_ (—Ü–µ–Ω–æ–π –ø–æ–∫—Ä—ã—Ç–∏—è –º–µ–Ω—å—à–∏—Ö —Ä–∏—Å–∫–æ–≤).

–°–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏–µ–º –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ (jest, mocha), –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞—é—Ç –≤—Å–µ –æ—Ç–≤–µ—Ç—ã —Å–µ—Ç–∏, —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É —Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–º OpenAPI –∏, –µ—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∫–∞–∫–æ–µ-–ª–∏–±–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ, –¥–µ–ª–∞—é—Ç —Ç–µ—Å—Ç –Ω–µ—É–¥–∞—á–Ω—ã–º —Å –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω–æ–π –æ—à–∏–±–∫–æ–π.

–° —ç—Ç–∏–º –Ω–æ–≤—ã–º –æ—Ä—É–∂–∏–µ–º –≤ –≤–∞—à–µ–º –∞—Ä—Å–µ–Ω–∞–ª–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ —É—Å–∏–ª–∏–π, –µ—â–µ –æ–¥–∏–Ω —Ä–∏—Å–∫ —Å–Ω—è—Ç. –ñ–∞–ª—å —Ç–æ–ª—å–∫–æ, —á—Ç–æ —ç—Ç–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–µ –º–æ–≥—É—Ç –∞—Å—Å–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã, —á—Ç–æ–±—ã —Å–æ–æ–±—â–∏—Ç—å –≤–∞–º, —á—Ç–æ –≤–∞—à–∏ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç API –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

–û–¥–Ω–∞ –Ω–µ–±–æ–ª—å—à–∞—è –æ–≥–æ–≤–æ—Ä–∫–∞ –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –≠—Ç–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ø—Ä–µ–¥–ø–∏—Å—ã–≤–∞—é—Ç –ø–æ–º–µ—â–∞—Ç—å —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤ –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç - expect(response).toSatisfyApiSpec(), —á—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ç–æ–º–∏—Ç–µ–ª—å–Ω–æ –∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã. –ï—Å–ª–∏ –≤–∞—à HTTP-–∫–ª–∏–µ–Ω—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–ª–∞–≥–∏–Ω—ã/—Ö—É–∫–∏/–∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä—ã, –≤—ã –º–æ–∂–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å –ª—É—á—à–µ, –ø–æ–º–µ—Å—Ç–∏–≤ —ç—Ç–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤ –æ–¥–Ω–æ –º–µ—Å—Ç–æ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –≤–æ –≤—Å–µ—Ö —Ç–µ—Å—Ç–∞—Ö:

**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π –∫–æ–¥, API –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å –æ—à–∏–±–∫–∏**.

```javascript
if (doesOrderCouponAlreadyExist) {
    throw new AppError('duplicated-coupon', {
        httpStatus: 409,
    });
}
```

OpenAPI –Ω–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ—Ç HTTP-—Å—Ç–∞—Ç—É—Å '409', –Ω–∏ –æ–¥–∏–Ω —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –Ω–µ –∑–Ω–∞–µ—Ç, –∫–∞–∫ –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é OpenAPI –Ω–∞ –æ—Å–Ω–æ–≤–µ –±—Ä–æ—à–µ–Ω–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π

```json
"responses": {
    "200": {
      "description": "successful",
      }
    ,
    "400": {
      "description": "Invalid ID",
      "content": {}
    },// No 409 in this listüò≤üëà
}

```

**–ö–æ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

```javascript
const jestOpenAPI = require('jest-openapi');
jestOpenAPI('../openapi.json');

test(
    'When an order with duplicated coupon is added,' +
        ' then 409 error should get returned',
    async () => {
        // Arrange
        const orderToAdd = {
            userId: 1,
            productId: 2,
            couponId: uuid(),
        };
        await axiosAPIClient.post('/order', orderToAdd);

        // Act
        // We're adding the same coupon twice üëá
        const receivedResponse = await axios.post(
            '/order',
            orderToAdd
        );

        // Assert;
        expect(receivedResponse.status).toBe(409);
        expect(res).toSatisfyApiSpec();
        // This üëÜ will throw if the API response, body or status,
        // is different that was it stated in the OpenAPI
    }
);
```

–¢—Ä—é–∫: –ï—Å–ª–∏ –≤–∞—à HTTP-–∫–ª–∏–µ–Ω—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–∫–æ–π-–ª–∏–±–æ –ø–ª–∞–≥–∏–Ω/—Ö—É–∫/–∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä, –ø–æ–º–µ—Å—Ç–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –≤ 'beforeAll'. –≠—Ç–æ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã –Ω–∞ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è OpenAPI

```javascript
beforeAll(() => {
    axios.interceptors.response.use((response) => {
        expect(response.toSatisfyApiSpec());
        // With this üëÜ, add nothing to the tests -
        // each will fail if the response deviates from the docs
    });
});
```

## –ï—â–µ –±–æ–ª—å—à–µ –∏–¥–µ–π

-   –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤
-   –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–±–æ–µ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
-   –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–∞–∑–æ–≤ JWT –∏ JWKS
-   –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –≤–µ—â–µ–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ç–æ–∫–µ–Ω—ã CSRF
-   –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ HTTP-–∫–ª–∏–µ–Ω—Ç–∞ (–æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ —Å –ø–æ–º–æ—â—å—é nock).
-   –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –ë–î –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ –∏ –Ω–æ–≤—ã–π –∫–æ–¥ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –∑–∞–ø–∏—Å–µ–π
-   –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –ë–î

## –≠—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∏–¥–µ–∏, —ç—Ç–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–æ–≤–æ–µ –º—ã—à–ª–µ–Ω–∏–µ.

–ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–µ –≤—ã—à–µ –ø—Ä–∏–º–µ—Ä—ã - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ "–Ω–µ –∑–∞–±—ã—Ç—å", –∞ —Å–∫–æ—Ä–µ–µ –Ω–æ–≤—ã–π –≤–∑–≥–ª—è–¥ –Ω–∞ —Ç–æ, —á—Ç–æ –º–æ–≥—É—Ç –¥–∞—Ç—å —Ç–µ—Å—Ç—ã. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–æ—Ç–æ–∫–∏, –Ω–æ –∏ –ª—é–±—ã–µ —Ä–∏—Å–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ—Å–µ—Ç–∏—Ç—å –≤–∞—à–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ.

–≠—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã—Ö/–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤, –Ω–æ –Ω–∏–∫–∞–∫ –Ω–µ —Å –ø–æ–º–æ—â—å—é –º–æ–¥—É–ª—å–Ω—ã—Ö –∏–ª–∏ —Å–∫–≤–æ–∑–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤. –ü–æ—á–µ–º—É? –ü–æ—Ç–æ–º—É —á—Ç–æ, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –º–æ–¥—É–ª—å–Ω—ã—Ö, –≤–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –≤—Å–µ —á–∞—Å—Ç–∏ —Ä–∞–±–æ—Ç–∞–ª–∏ –≤–º–µ—Å—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ñ–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î, —Å–ª–æ–π DAL –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ - –≤—Å–µ –≤–º–µ—Å—Ç–µ).

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç E2E, —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø–æ–¥—Ä–∞–∂–∞–Ω–∏—è. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –≤–∫–ª—é—á–∞—Ç—å –º–Ω–æ–≥–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–≤–∏–∂—É—â–∏–µ—Å—è —á–∞—Å—Ç–∏ –Ω–∞ —Ä–∞–Ω–Ω–∏—Ö —ç—Ç–∞–ø–∞—Ö —Ä–∞–±–æ—Ç—ã. –ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –Ω–∞–∑—ã–≤–∞—Ç—å —ç—Ç–æ "–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π".

<small>:material-information-outline: –ò—Å—Ç–æ—á–Ω–∏–∫ &mdash; <https://practica.dev/blog/testing-the-dark-scenarios-of-your-nodejs-application/></small>
